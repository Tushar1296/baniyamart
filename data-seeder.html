<!DOCTYPE html>
<html>
  <head>
    <title>Fresh BaniyaMart Seeder</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        padding: 20px;
      }
      .log {
        padding: 8px;
        margin: 4px 0;
        border-radius: 4px;
      }
      .success {
        background: #d4edda;
        color: #155724;
      }
      .error {
        background: #f8d7da;
        color: #721c24;
      }
      .info {
        background: #e2e3e5;
        color: #383d41;
      }
      button {
        padding: 12px 24px;
        font-size: 16px;
        margin: 10px;
        background: #007bff;
        color: white;
        border: none;
        border-radius: 4px;
      }
      button:hover {
        background: #0056b3;
      }
    </style>
  </head>
  <body>
    <h1>ðŸ›’ Fresh BaniyaMart Seeder</h1>
    <p>This will add all categories and products in one go.</p>

    <button onclick="seedEverything()">ðŸš€ Seed All Data</button>
    <button onclick="clearLogs()">Clear Logs</button>

    <div id="logs"></div>

    <script>
      const API_BASE = "http://localhost:8080/api";

      function log(message, type = "info") {
        const div = document.createElement("div");
        div.className = `log ${type}`;
        div.textContent = `${new Date().toLocaleTimeString()}: ${message}`;
        document.getElementById("logs").appendChild(div);
      }

      function clearLogs() {
        document.getElementById("logs").innerHTML = "";
      }

      async function seedEverything() {
        log("ðŸš€ Starting fresh seeding...");

        // Categories with simple names (no special characters)
        const categories = [
          { name: "Vegetables", icon: "ðŸ¥•" },
          { name: "Fruits", icon: "ðŸŽ" },
          { name: "Dairy", icon: "ðŸ¥›" },
          { name: "Bakery", icon: "ðŸž" },
          { name: "Meat", icon: "ðŸ–" },
          { name: "Snacks", icon: "ðŸ¿" },
          { name: "Beverages", icon: "ðŸ¥¤" },
          { name: "Personal Care", icon: "ðŸ§´" },
        ];

        const categoryMap = {};

        // Step 1: Add all categories
        log("ðŸ“ Adding categories...", "info");
        for (const category of categories) {
          try {
            const response = await fetch(`${API_BASE}/categories`, {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify(category),
            });

            if (response.ok) {
              const result = await response.json();
              categoryMap[category.name] = result.id;
              log(`âœ… Added: ${category.icon} ${category.name}`, "success");
            } else {
              log(`âŒ Failed: ${category.name}`, "error");
            }
          } catch (error) {
            log(`âŒ Error adding ${category.name}: ${error.message}`, "error");
          }
          await sleep(200);
        }

        // Step 2: Add all products
        log("ðŸ“¦ Adding products...", "info");
        const products = [
          // Vegetables
          {
            name: "Fresh Carrots",
            description: "Organic carrots - 1kg",
            price: 60,
            category: "Vegetables",
            quantity: 50,
            featured: true,
          },
          {
            name: "Green Spinach",
            description: "Fresh spinach - 250g",
            price: 40,
            category: "Vegetables",
            quantity: 30,
            featured: false,
          },
          {
            name: "Red Tomatoes",
            description: "Ripe tomatoes - 500g",
            price: 35,
            category: "Vegetables",
            quantity: 40,
            featured: false,
          },
          {
            name: "Fresh Onions",
            description: "White onions - 1kg",
            price: 30,
            category: "Vegetables",
            quantity: 60,
            featured: false,
          },

          // Fruits
          {
            name: "Red Apples",
            description: "Kashmir apples - 1kg",
            price: 180,
            category: "Fruits",
            quantity: 25,
            featured: true,
          },
          {
            name: "Yellow Bananas",
            description: "Fresh bananas - 1 dozen",
            price: 50,
            category: "Fruits",
            quantity: 40,
            featured: false,
          },
          {
            name: "Sweet Oranges",
            description: "Juicy oranges - 1kg",
            price: 80,
            category: "Fruits",
            quantity: 30,
            featured: true,
          },
          {
            name: "Green Grapes",
            description: "Fresh grapes - 500g",
            price: 120,
            category: "Fruits",
            quantity: 20,
            featured: false,
          },

          // Dairy
          {
            name: "Fresh Milk",
            description: "Full cream milk - 1L",
            price: 60,
            category: "Dairy",
            quantity: 20,
            featured: true,
          },
          {
            name: "Greek Yogurt",
            description: "Creamy yogurt - 400g",
            price: 45,
            category: "Dairy",
            quantity: 15,
            featured: false,
          },
          {
            name: "Paneer",
            description: "Fresh paneer - 200g",
            price: 80,
            category: "Dairy",
            quantity: 25,
            featured: false,
          },
          {
            name: "Butter",
            description: "White butter - 100g",
            price: 50,
            category: "Dairy",
            quantity: 30,
            featured: false,
          },

          // Bakery
          {
            name: "Wheat Bread",
            description: "Whole wheat bread - 400g",
            price: 35,
            category: "Bakery",
            quantity: 25,
            featured: false,
          },
          {
            name: "Croissants",
            description: "Butter croissants - Pack of 4",
            price: 120,
            category: "Bakery",
            quantity: 12,
            featured: true,
          },
          {
            name: "Cookies",
            description: "Chocolate cookies - 200g",
            price: 65,
            category: "Bakery",
            quantity: 20,
            featured: false,
          },

          // Meat
          {
            name: "Chicken Breast",
            description: "Fresh chicken breast - 500g",
            price: 280,
            category: "Meat",
            quantity: 15,
            featured: true,
          },
          {
            name: "Fish Fillet",
            description: "Fresh fish fillet - 400g",
            price: 320,
            category: "Meat",
            quantity: 10,
            featured: false,
          },
          {
            name: "Mutton",
            description: "Fresh mutton - 500g",
            price: 450,
            category: "Meat",
            quantity: 8,
            featured: false,
          },

          // Snacks
          {
            name: "Mixed Nuts",
            description: "Premium nuts - 250g",
            price: 180,
            category: "Snacks",
            quantity: 25,
            featured: true,
          },
          {
            name: "Potato Chips",
            description: "Crispy chips - 150g",
            price: 45,
            category: "Snacks",
            quantity: 30,
            featured: false,
          },
          {
            name: "Biscuits",
            description: "Tea biscuits - 300g",
            price: 35,
            category: "Snacks",
            quantity: 40,
            featured: false,
          },
          {
            name: "Namkeen",
            description: "Spicy namkeen - 200g",
            price: 40,
            category: "Snacks",
            quantity: 35,
            featured: false,
          },

          // Beverages
          {
            name: "Orange Juice",
            description: "Fresh orange juice - 1L",
            price: 120,
            category: "Beverages",
            quantity: 18,
            featured: true,
          },
          {
            name: "Green Tea",
            description: "Premium green tea - 100g",
            price: 150,
            category: "Beverages",
            quantity: 25,
            featured: false,
          },
          {
            name: "Mineral Water",
            description: "Pure water - 1L",
            price: 25,
            category: "Beverages",
            quantity: 50,
            featured: false,
          },
          {
            name: "Coffee",
            description: "Instant coffee - 100g",
            price: 180,
            category: "Beverages",
            quantity: 20,
            featured: false,
          },

          // Personal Care
          {
            name: "Shampoo",
            description: "Herbal shampoo - 400ml",
            price: 180,
            category: "Personal Care",
            quantity: 20,
            featured: true,
          },
          {
            name: "Soap",
            description: "Natural soap - 100g",
            price: 45,
            category: "Personal Care",
            quantity: 35,
            featured: false,
          },
          {
            name: "Hand Sanitizer",
            description: "Hand sanitizer - 500ml",
            price: 95,
            category: "Personal Care",
            quantity: 40,
            featured: false,
          },
          {
            name: "Toothpaste",
            description: "Herbal toothpaste - 100g",
            price: 65,
            category: "Personal Care",
            quantity: 30,
            featured: false,
          },
        ];

        for (const product of products) {
          const categoryId = categoryMap[product.category];
          if (!categoryId) {
            log(`âŒ Category not found: ${product.category}`, "error");
            continue;
          }

          const productData = {
            name: product.name,
            description: product.description,
            price: product.price,
            categoryId: categoryId,
            quantity: product.quantity,
            featured: product.featured,
            imageUrl: `https://via.placeholder.com/300x200?text=${encodeURIComponent(
              product.name
            )}`,
          };

          try {
            const response = await fetch(`${API_BASE}/products`, {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify(productData),
            });

            if (response.ok) {
              log(`âœ… Added: ${product.name} (â‚¹${product.price})`, "success");
            } else {
              log(`âŒ Failed: ${product.name}`, "error");
            }
          } catch (error) {
            log(`âŒ Error: ${product.name} - ${error.message}`, "error");
          }

          await sleep(150);
        }

        log("ðŸŽ‰ Seeding completed!", "success");
        log(
          `ðŸ“Š Added ${Object.keys(categoryMap).length} categories and ${
            products.length
          } products`,
          "info"
        );
      }

      function sleep(ms) {
        return new Promise((resolve) => setTimeout(resolve, ms));
      }
    </script>
  </body>
</html>
